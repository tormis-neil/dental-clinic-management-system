 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Edit Medical Information — Kit & Dom's Dental Clinic</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600&family=Inter:wght@400;500&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Inter', sans-serif;
  background: #F7F8FA;
  margin: 0;
  padding: 32px;
  color: #1A1A1A;
}
.container { max-width: 900px; margin: auto; }
h1 { font-family: 'Poppins'; font-size: 22px; font-weight: 600; margin-bottom: 6px; }
.subtitle { font-size: 14px; color: #64748B; margin-bottom: 20px; }

label { display: block; font-size: 13px; color: #64748B; margin-bottom: 4px; }
input, textarea {
  width: 100%; padding: 9px 12px; border-radius: 8px;
  border: 1px solid #E2E8F0; font-size: 14px; background: #fff;
}
input:focus, textarea:focus {
  border-color: #E8B4BC; box-shadow: 0 0 0 3px rgba(232,180,188,0.2); outline: none;
}

/* Card */
.form-card {
  background: #fff; border-radius: 12px; padding: 24px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

/* Buttons */
.btn-row { display: flex; justify-content: flex-end; gap: 12px; margin-top: 24px; }
.btn {
  padding: 10px 18px; border-radius: 8px; font-family: 'Poppins';
  cursor: pointer; border: 0; font-size: 14px;
}
.btn-cancel { background: #fff; border: 2px solid #E2E8F0; color: #64748B; }
.btn-cancel:hover { background: #F1F5F9; }
.btn-save {
  background: #E8B4BC; color: #fff; box-shadow: 0 2px 6px rgba(232,180,188,0.3);
}
.btn-save:hover { background: #D89BA7; }

/* Back button */
.back-btn {
  display: flex; align-items: center; gap: 6px;
  cursor: pointer; margin-bottom: 12px;
  color: #D89BA7; font-size: 14px;
}
.back-btn svg { width: 18px; height: 18px; }
</style>
</head>

<body>
<div class="container">

  <div class="back-btn" onclick="goBack()">
    <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path d="M15 18l-6-6 6-6"></path>
    </svg>
    Back to Patient Profile
  </div>

  <h1>Edit Medical Information</h1>
  <div class="subtitle">Update allergies, conditions, and notes for this patient.</div>

  <div class="form-card">
    <form id="medicalForm">
      <label>Allergies</label>
      <textarea id="m_allergies" rows="2" placeholder="e.g. Penicillin, latex"></textarea>

      <label>Existing Conditions</label>
      <textarea id="m_conditions" rows="2" placeholder="e.g. Hypertension, diabetes"></textarea>

      <label>Dentist Notes / Diagnosis</label>
      <textarea id="m_notes" rows="3" placeholder="e.g. Requires crown procedure"></textarea>

      <label>Assigned Dentist</label>
      <input id="m_assigned" placeholder="e.g. Dr. Maria Santos" />

      <div class="btn-row">
        <button type="button" class="btn btn-cancel" onclick="goBack()">Cancel</button>
        <button type="submit" class="btn btn-save">Save Changes</button>
      </div>
    </form>
  </div>
</div>

<script>
/* Load selected patient (from patient_view.html) */
let patient = JSON.parse(localStorage.getItem("selectedPatient") || "null");
if (!patient) {
  alert("No patient data found. Redirecting to patient list.");
  window.location.href = "patients.html";
}

/* Populate form fields */
document.getElementById("m_allergies").value = patient.medical?.allergies || "";
document.getElementById("m_conditions").value = patient.medical?.conditions || "";
document.getElementById("m_notes").value = patient.medical?.dentistNotes || "";
document.getElementById("m_assigned").value = patient.medical?.assignedDentist || "";

/* Save changes */
document.getElementById("medicalForm").addEventListener("submit", e => {
  e.preventDefault();

  const updatedMedical = {
    allergies: document.getElementById("m_allergies").value.trim(),
    conditions: document.getElementById("m_conditions").value.trim(),
    dentistNotes: document.getElementById("m_notes").value.trim(),
    assignedDentist: document.getElementById("m_assigned").value.trim()
  };

  // Update patient object
  patient.medical = updatedMedical;

  // Save back to localStorage
  localStorage.setItem("selectedPatient", JSON.stringify(patient));

  alert("✅ Medical information updated successfully (demo)");
  window.location.href = "patient_view.html";
});

/* Go back to patient profile */
function goBack() {
  window.location.href = "patient_view.html";
}
</script>
</body>
</html>
