 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Edit Patient — Kit & Dom's Dental Clinic</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600&family=Inter:wght@400;500&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#F7F8FA;color:#1A1A1A;padding:32px;}
h1{font-family:'Poppins';font-size:22px;font-weight:600;margin-bottom:4px}
.subtitle{font-size:14px;color:#64748B;margin-bottom:24px}
label{font-size:13px;color:#64748B;margin-bottom:4px;display:block}
input,select,textarea{
  width:100%;padding:9px 12px;border:1px solid #E2E8F0;border-radius:8px;
  font-size:14px;font-family:inherit;background:#fff;
}
input:focus,select:focus,textarea:focus{
  border-color:#E8B4BC;box-shadow:0 0 0 3px rgba(232,180,188,0.2);
  outline:none;
}

.container{max-width:1200px;margin:auto}
.form-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:24px;
  background:white;
  padding:24px;
  border-radius:12px;
  box-shadow:0 2px 6px rgba(0,0,0,0.08);
}

.section-title{
  font-family:'Poppins';font-size:15px;font-weight:600;
  margin-bottom:10px;margin-top:12px;
}

.btn-row{display:flex;justify-content:flex-end;gap:12px;margin-top:24px}
.btn{padding:10px 18px;border-radius:8px;font-family:'Poppins';cursor:pointer;border:0}
.btn-cancel{background:#fff;border:2px solid #E2E8F0;color:#64748B}
.btn-cancel:hover{background:#F1F5F9}
.btn-save{background:#E8B4BC;color:#fff;box-shadow:0 2px 6px rgba(232,180,188,0.3)}
.btn-save:hover{background:#D89BA7}

.back-btn{display:flex;align-items:center;font-size:14px;color:#D89BA7;margin-bottom:12px;cursor:pointer}
.back-btn svg{width:18px;height:18px;margin-right:6px}
</style>
</head>

<body>
<div class="container">

<!-- Back link -->
<div class="back-btn" onclick="goBack()">
  <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
    <path d="M15 18l-6-6 6-6"></path>
  </svg>
  Back to Patient Profile
</div>

<h1>Edit Patient Information</h1>
<div class="subtitle">Update patient details and medical history. Fields depend on your role.</div>

<div class="form-grid">

  <!-- PERSONAL INFO -->
  <div>
    <div class="section-title">Personal Information</div>

    <label>Patient ID</label>
    <input id="p_id" disabled />

    <label>First Name *</label>
    <input id="p_first" required />

    <label>Last Name *</label>
    <input id="p_last" required />

    <label>Gender</label>
    <select id="p_gender">
      <option>Male</option><option>Female</option><option>Other</option>
    </select>

    <label>Date of Birth</label>
    <input type="date" id="p_dob" />

    <label>Contact Number</label>
    <input id="p_contact" />

    <label>Address</label>
    <input id="p_address" />
  </div>

  <!-- MEDICAL INFO -->
  <div>
    <div class="section-title">Medical Information</div>

    <label>Allergies</label>
    <textarea id="p_allergies" rows="2" placeholder="e.g. Penicillin, latex"></textarea>

    <label>Existing Conditions</label>
    <textarea id="p_conditions" rows="2" placeholder="e.g. Hypertension, diabetes"></textarea>

    <label>Dentist Notes / Diagnosis</label>
    <textarea id="p_notes" rows="4" placeholder="e.g. Requires crown procedure"></textarea>

    <label>Assigned Dentist</label>
    <input id="p_assigned" placeholder="e.g. Dr. Maria Santos" />

    <label>Status</label>
    <select id="p_status">
      <option value="active">Active</option>
      <option value="inactive">Inactive</option>
    </select>

    <label>Last Visit</label>
    <input type="date" id="p_lastVisit" />
  </div>

</div>

<div class="btn-row">
  <button class="btn btn-cancel" onclick="goBack()">Cancel</button>
  <button class="btn btn-save" onclick="savePatient()">Save Changes</button>
</div>

</div>

<script>
 // Load patient data saved by patient_view.html
let patient = JSON.parse(localStorage.getItem("selectedPatient") || "null");

// Fallback demo data (for standalone testing)
if (!patient) {
  patient = {
    id:"PT-0001",
    firstName:"Jane",
    lastName:"Cruz",
    gender:"Female",
    birth:"1995-06-12",
    contact:"09171234567",
    address:"Makati City",
    allergies:"Penicillin",
    conditions:"Hypertension",
    notes:"Routine cleaning",
    assigned:"Dr. Maria Santos",
    status:"active",
    lastVisit:"2025-10-18"
  };
}


// Populate form
document.getElementById('p_id').value = patient.id || '';
document.getElementById('p_first').value = patient.firstName || '';
document.getElementById('p_last').value = patient.lastName || '';
document.getElementById('p_gender').value = patient.gender || 'Male';
document.getElementById('p_dob').value = patient.dob || '';
document.getElementById('p_contact').value = patient.contact || '';
document.getElementById('p_address').value = patient.address || '';
document.getElementById('p_allergies').value = patient.medical?.allergies || '';
document.getElementById('p_conditions').value = patient.medical?.conditions || '';
document.getElementById('p_notes').value = patient.medical?.dentistNotes || '';
document.getElementById('p_assigned').value = patient.medical?.assignedDentist || '';
document.getElementById('p_status').value = patient.status || 'active';
document.getElementById('p_lastVisit').value = patient.lastVisit || '';

// Save updated info
function savePatient() {
  const updated = {
    ...patient,
    firstName: document.getElementById('p_first').value.trim(),
    lastName: document.getElementById('p_last').value.trim(),
    gender: document.getElementById('p_gender').value,
    dob: document.getElementById('p_dob').value,
    contact: document.getElementById('p_contact').value.trim(),
    address: document.getElementById('p_address').value.trim(),
    status: document.getElementById('p_status').value,
    lastVisit: document.getElementById('p_lastVisit').value,
    medical: {
      allergies: document.getElementById('p_allergies').value.trim(),
      conditions: document.getElementById('p_conditions').value.trim(),
      dentistNotes: document.getElementById('p_notes').value.trim(),
      assignedDentist: document.getElementById('p_assigned').value.trim()
    }
  };

  localStorage.setItem('selectedPatient', JSON.stringify(updated));
  alert("✅ Patient record updated successfully (demo)");
  window.location.href = "patient_view.html";
}

// Go back
function goBack() {
  window.location.href = "patient_view.html";
}
</script>

</body>
</html>
